#!/bin/bash
set -e

mkdir -p $XDG_RUNTIME_DIR -m 700
mkdir -p $XDG_CACHE_HOME

# Make PulseAudio socket available inside the snap-specific $XDG_RUNTIME_DIR
pulsenative="pulse/native"
pulseaudio_sockpath="$XDG_RUNTIME_DIR/$pulsenative"
if [ -S "$pulseaudio_sockpath" ]; then
    export PULSE_SERVER="unix:${pulseaudio_sockpath}"
fi

cd $HOME
unset DISPLAY # How does this get set?!
desktop-launch $SNAP/bin/egmde $@

